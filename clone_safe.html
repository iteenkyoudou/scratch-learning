<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¯ãƒ­ãƒ¼ãƒ³æ©Ÿèƒ½ - å®‰å…¨ç‰ˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f5ff;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .header {
            background: #7C3F9E;
            color: white;
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
        }
        .animation-area {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            height: 300px;
            position: relative;
            overflow: visible;
        }
        .sprite {
            width: 50px;
            height: 50px;
            background: #ff6b6b;
            border-radius: 50%;
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            font-weight: bold;
            border: 3px solid #333;
        }
        .btn {
            background: #7C3F9E;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px;
        }
        .status {
            background: #e8f4fd;
            border: 2px solid #4A90E2;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-weight: bold;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§¬ ã‚¯ãƒ­ãƒ¼ãƒ³æ©Ÿèƒ½ - å®‰å…¨ç‰ˆ</h1>
            <p>ã‚·ãƒ³ãƒ—ãƒ«ã§ç¢ºå®Ÿãªã‚¯ãƒ­ãƒ¼ãƒ³ä½œæˆ</p>
        </div>

        <div class="animation-area" id="animation-area">
            <div id="main-sprite" class="sprite" style="left: 50px; top: 50px;">ğŸ˜¸</div>
        </div>
        
        <div id="status" class="status">
            æº–å‚™å®Œäº†
        </div>
        
        <div style="text-align: center;">
            <button class="btn" onclick="createOneClone()">1ã¤ã‚¯ãƒ­ãƒ¼ãƒ³ä½œæˆ</button>
            <button class="btn" onclick="createThreeClones()">3ã¤ã‚¯ãƒ­ãƒ¼ãƒ³ä½œæˆ</button>
            <button class="btn" onclick="clearAll()">ã™ã¹ã¦ã‚¯ãƒªã‚¢</button>
            <button class="btn" onclick="showInfo()">æƒ…å ±è¡¨ç¤º</button>
        </div>
    </div>

    <script>
        console.log('å®‰å…¨ç‰ˆã‚¯ãƒ­ãƒ¼ãƒ³æ©Ÿèƒ½é–‹å§‹');

        function createOneClone() {
            console.log('=== 1ã¤ã‚¯ãƒ­ãƒ¼ãƒ³ä½œæˆé–‹å§‹ ===');
            
            try {
                const sprite = document.getElementById('main-sprite');
                const area = document.getElementById('animation-area');
                const status = document.getElementById('status');
                
                if (!sprite || !area || !status) {
                    console.error('è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                    alert('è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                    return;
                }
                
                console.log('å…ƒã‚¹ãƒ—ãƒ©ã‚¤ãƒˆ:', sprite);
                console.log('ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é ˜åŸŸ:', area);
                
                // ã‚¯ãƒ­ãƒ¼ãƒ³ã‚’ä½œæˆ
                const clone = sprite.cloneNode(true);
                clone.id = 'test-clone-1';
                clone.style.left = '200px';
                clone.style.top = '100px';
                clone.style.background = 'blue';
                
                console.log('ä½œæˆã—ãŸã‚¯ãƒ­ãƒ¼ãƒ³:', clone);
                console.log('ã‚¯ãƒ­ãƒ¼ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«:', clone.style.cssText);
                
                // è¦ªè¦ç´ ã«è¿½åŠ 
                area.appendChild(clone);
                
                console.log('ã‚¯ãƒ­ãƒ¼ãƒ³ã‚’è¿½åŠ ã—ã¾ã—ãŸ');
                
                // è¿½åŠ ã•ã‚ŒãŸã‹ç¢ºèª
                const addedClone = document.getElementById('test-clone-1');
                console.log('è¿½åŠ ã•ã‚ŒãŸã‚¯ãƒ­ãƒ¼ãƒ³:', addedClone);
                
                if (addedClone) {
                    const rect = addedClone.getBoundingClientRect();
                    console.log('ã‚¯ãƒ­ãƒ¼ãƒ³ã®ä½ç½®æƒ…å ±:', rect);
                    status.textContent = 'âœ… ã‚¯ãƒ­ãƒ¼ãƒ³1å€‹ä½œæˆæˆåŠŸï¼';
                } else {
                    console.error('ã‚¯ãƒ­ãƒ¼ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                    status.textContent = 'âŒ ã‚¯ãƒ­ãƒ¼ãƒ³ä½œæˆå¤±æ•—';
                }
                
            } catch (error) {
                console.error('ã‚¨ãƒ©ãƒ¼:', error);
                document.getElementById('status').textContent = 'ã‚¨ãƒ©ãƒ¼: ' + error.message;
            }
            
            console.log('=== 1ã¤ã‚¯ãƒ­ãƒ¼ãƒ³ä½œæˆçµ‚äº† ===');
        }

        function createThreeClones() {
            console.log('=== 3ã¤ã‚¯ãƒ­ãƒ¼ãƒ³ä½œæˆé–‹å§‹ ===');
            
            try {
                const sprite = document.getElementById('main-sprite');
                const area = document.getElementById('animation-area');
                const status = document.getElementById('status');
                
                if (!sprite || !area || !status) {
                    console.error('è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                    return;
                }
                
                // æ—¢å­˜ã®ã‚¯ãƒ­ãƒ¼ãƒ³ã‚’ã‚¯ãƒªã‚¢
                clearAll();
                
                // 3ã¤ã®ã‚¯ãƒ­ãƒ¼ãƒ³ã‚’ä½œæˆ
                for (let i = 1; i <= 3; i++) {
                    console.log(`ã‚¯ãƒ­ãƒ¼ãƒ³${i}ä½œæˆä¸­...`);
                    
                    const clone = sprite.cloneNode(true);
                    clone.id = `multi-clone-${i}`;
                    clone.style.left = (50 + i * 100) + 'px';
                    clone.style.top = (50 + i * 30) + 'px';
                    clone.style.background = `hsl(${i * 120}, 70%, 60%)`;
                    
                    console.log(`ã‚¯ãƒ­ãƒ¼ãƒ³${i}ã®ã‚¹ã‚¿ã‚¤ãƒ«:`, clone.style.cssText);
                    
                    area.appendChild(clone);
                    
                    const addedClone = document.getElementById(`multi-clone-${i}`);
                    console.log(`ã‚¯ãƒ­ãƒ¼ãƒ³${i}è¿½åŠ ç¢ºèª:`, addedClone);
                }
                
                status.textContent = 'âœ… 3ã¤ã®ã‚¯ãƒ­ãƒ¼ãƒ³ä½œæˆå®Œäº†ï¼';
                
            } catch (error) {
                console.error('ã‚¨ãƒ©ãƒ¼:', error);
                document.getElementById('status').textContent = 'ã‚¨ãƒ©ãƒ¼: ' + error.message;
            }
            
            console.log('=== 3ã¤ã‚¯ãƒ­ãƒ¼ãƒ³ä½œæˆçµ‚äº† ===');
        }

        function clearAll() {
            console.log('=== ã‚¯ãƒªã‚¢é–‹å§‹ ===');
            
            const clones = document.querySelectorAll('[id*="clone"]');
            console.log('å‰Šé™¤å¯¾è±¡ã‚¯ãƒ­ãƒ¼ãƒ³æ•°:', clones.length);
            
            clones.forEach((clone, index) => {
                console.log(`ã‚¯ãƒ­ãƒ¼ãƒ³${index + 1}(${clone.id})ã‚’å‰Šé™¤`);
                clone.remove();
            });
            
            document.getElementById('status').textContent = 'ã™ã¹ã¦ã‚¯ãƒªã‚¢å®Œäº†';
            console.log('=== ã‚¯ãƒªã‚¢çµ‚äº† ===');
        }

        function showInfo() {
            console.log('=== æƒ…å ±è¡¨ç¤ºé–‹å§‹ ===');
            
            const area = document.getElementById('animation-area');
            const allChildren = area.children;
            
            console.log('ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é ˜åŸŸ:', area);
            console.log('å­è¦ç´ æ•°:', allChildren.length);
            
            for (let i = 0; i < allChildren.length; i++) {
                const child = allChildren[i];
                const rect = child.getBoundingClientRect();
                console.log(`è¦ç´ ${i + 1}:`, {
                    id: child.id,
                    className: child.className,
                    innerHTML: child.innerHTML,
                    style: child.style.cssText,
                    computedStyle: {
                        display: getComputedStyle(child).display,
                        position: getComputedStyle(child).position,
                        left: getComputedStyle(child).left,
                        top: getComputedStyle(child).top
                    },
                    boundingRect: rect
                });
            }
            
            const clones = document.querySelectorAll('[id*="clone"]');
            console.log('ã‚¯ãƒ­ãƒ¼ãƒ³è¦ç´ :', clones);
            
            document.getElementById('status').textContent = `æƒ…å ±è¡¨ç¤º: è¦ç´ ${allChildren.length}å€‹ã€ã‚¯ãƒ­ãƒ¼ãƒ³${clones.length}å€‹`;
            
            console.log('=== æƒ…å ±è¡¨ç¤ºçµ‚äº† ===');
        }

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚
        window.addEventListener('load', function() {
            console.log('ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰å®Œäº†');
            showInfo();
        });
    </script>
</body>
</html>